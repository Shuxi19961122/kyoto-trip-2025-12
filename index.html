<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>京都2025秋楓之旅 - 木紋雅緻版</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* 雅緻和風配色與排版調整 */
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; 
            background-color: #fcfaf0; /* 暖米色/和紙色 */
        }
        /* >>> 時間軸線條：極致加粗與深木色調整 (4px) <<< */
        .timeline-line { 
            position: absolute; 
            left: 24px; 
            top: 30px; 
            bottom: -20px; 
            width: 4px; /* 更粗的線 (4px) */
            background-color: #5C4033; /* 極深的木碳棕色 */
            opacity: 1; 
            z-index: 0; 
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.1); /* 增加明顯陰影 */
        }
        .last-item .timeline-line { display: none; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        /* 調整 Header 陰影，使其更柔和 */
        .kyoto-header {
             box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -2px rgba(0, 0, 0, 0.03); 
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // *** 重要提醒：所有 link 欄位皆已替換為安全佔位符。請手動替換為您的 Google Maps 或 Apple Maps 實際網址。***
        const tripData = [
            {
                day: 1,
                date: "11.28 (五)",
                location: "台灣 -> 台北",
                weather: { temp: "21°~18°", icon: "cloud", desc: "預估: 舒適 (隔早轉冷)" },
                activities: [
                    { time: "13:00", type: "transport", name: "豐原車站", desc: "坐自強號前往台北", duration: "129分", icon: "train", cost: "N/A", details: "坐自強", link: "#map-link-1" },
                    { time: "15:20", type: "transport", name: "台北車站", desc: "轉捷運往淡水", duration: "50分", icon: "subway", cost: "N/A", details: "", link: "#map-link-2" },
                    { time: "16:25", type: "spot", name: "捷運淡水站", desc: "看天氣決定是否停留", duration: "95分", icon: "location-dot", cost: "N/A", details: "※看天氣 再決定要不要去" },
                    { time: "20:00", type: "transport", name: "桃園機場", desc: "前往機場準備過夜", duration: "", icon: "plane-departure", cost: "N/A", details: "", link: "#map-link-3" }
                ]
            },
            {
                day: 2,
                date: "11.29 (六)",
                location: "京都市區 (車站周圍)",
                weather: { temp: "15°~6°", icon: "sun", desc: "即時預報: 晴朗 (Sunny)" },
                activities: [
                    { time: "05:00", type: "transport", name: "長榮櫃台", desc: "05:00 開櫃", duration: "30分", icon: "ticket", cost: "N/A", details: "", link: "#map-link-4" },
                    { time: "06:30", type: "transport", name: "起飛 BR-178", desc: "飛往關西機場", duration: "150分", icon: "plane", cost: "N/A", details: "", link: "#map-link-5" },
                    { time: "09:55", type: "arrival", name: "關西機場", desc: "抵達 (東京時間)", duration: "35分", icon: "plane-arrival", cost: "N/A", details: "" },
                    { time: "10:45", type: "transport", name: "機場車站", desc: "開 KLOOK 刷 QR 進站", duration: "20分", icon: "train", cost: "N/A", details: "", link: "#map-link-6" },
                    { time: "12:31", type: "transport", name: "抵達京都車站", desc: "JR 哈囉凱蒂", duration: "20分", icon: "train", cost: "N/A", details: "" },
                    { time: "13:10", type: "hotel", name: "王子飯店", desc: "計程車過去放行李", duration: "20分", icon: "hotel", cost: "N/A", details: "" },
                    { time: "13:40", type: "spot", name: "護國寺 (東寺)", desc: "公車 207 或 17", duration: "60分", icon: "gopuram", cost: "￥500", hours: "08:00~17:00", details: "" },
                    { time: "14:55", type: "spot", name: "西本願寺", desc: "金黃銀杏必看", duration: "40分", icon: "tree", cost: "Free", hours: "05:30~17:30", details: "" },
                    { time: "15:46", type: "spot", name: "東本願寺", desc: "日落前速拍", duration: "44分", icon: "camera", cost: "Free", hours: "05:30~17:30", details: "" },
                    { time: "17:00", type: "food", name: "麵屋 豬一", desc: "現場排隊 (不能預約)", duration: "60分", icon: "utensils", link: "#map-link-7", cost: "N/A", hours: "N/A", details: "" },
                    { time: "18:20", type: "shop", name: "京都 LOFT", desc: "買衣服、逛街", duration: "120分", icon: "bag-shopping", cost: "N/A", hours: "N/A", details: "" }
                ]
            },
            {
                day: 3,
                date: "11.30 (日)",
                location: "京都左京 (叡山鞍馬)",
                weather: { temp: "18°~7°", icon: "sun", desc: "即時預報: 多數晴朗 (Mostly Sunny)" },
                activities: [
                    { time: "07:00", type: "transport", name: "出門", desc: "06:45 日出", duration: "", icon: "person-walking", cost: "N/A", details: "", link: "#map-link-8" },
                    { time: "07:33", type: "transport", name: "河原町今出川", desc: "公車 3 號", duration: "27分", icon: "bus", cost: "N/A", details: "", link: "#map-link-9" },
                    { time: "08:15", type: "spot", name: "下鴨神社", desc: "買限定御守 (9點開)", duration: "60分", icon: "torii-gate", cost: "N/A", hours: "06:30~17:00", details: "御株印 9:00 開" },
                    { time: "10:05", type: "spot", name: "鞍馬寺", desc: "爬山行程，注意熊出沒", duration: "115分", icon: "mountain", cost: "￥470", hours: "N/A", details: "" },
                    { time: "12:10", type: "spot", name: "貴船神社", desc: "著名紅燈籠", duration: "30分", icon: "torii-gate", cost: "N/A", hours: "09:00~17:00", details: "" },
                    { time: "13:35", type: "transport", name: "貴船巴士站", desc: "前往一乘寺", duration: "", icon: "bus", cost: "N/A", details: "", link: "#map-link-10" },
                    { time: "14:40", type: "spot", name: "詩仙堂", desc: "庭園造景", duration: "30分", icon: "leaf", cost: "￥700", hours: "09:00~17:00", details: "" },
                    { time: "17:40", type: "food", name: "牛樂亭", desc: "已訂位 18:00", duration: "110分", icon: "utensils", cost: "N/A", hours: "N/A", details: "" }
                ]
            },
            {
                day: 4,
                date: "12.01 (一)",
                location: "京都左京 (大原周圍)",
                weather: { temp: "19°~10°", icon: "cloud-sun", desc: "即時預報: 多雲間歇晴朗" },
                activities: [
                    { time: "07:00", type: "transport", name: "出門", desc: "前往四条高倉", duration: "", icon: "person-walking", cost: "N/A", details: "", link: "#map-link-11" },
                    { time: "08:22", type: "transport", name: "抵達大原", desc: "公車特17", duration: "", icon: "bus", cost: "N/A", details: "", link: "#map-link-12" },
                    { time: "09:00", type: "spot", name: "三千院", desc: "大原賞楓名所", duration: "40分", icon: "tree", cost: "￥700", hours: "08:30~17:00", details: "" },
                    { time: "09:45", type: "spot", name: "寶光院 & 勝林院", desc: "周邊寺廟巡禮", duration: "60分", icon: "gopuram", cost: "N/A", hours: "N/A", details: "" },
                    { time: "11:22", type: "food", name: "芹生茶屋", desc: "蕎麥麵、蕨餅", duration: "38分", icon: "utensils", cost: "N/A", hours: "N/A", details: "" },
                    { time: "12:30", type: "spot", name: "寂光院", desc: "能提早就提早", duration: "40分", icon: "gopuram", cost: "N/A", hours: "N/A", details: "" },
                    { time: "14:00", type: "spot", name: "琉璃光院(外圍)", desc: "沒抽到籤，逛周圍", duration: "40分", icon: "camera", cost: "N/A", hours: "N/A", details: "" },
                    { time: "16:17", type: "spot", name: "寶池公園", desc: "日落散步", duration: "50分", icon: "tree", cost: "N/A", hours: "N/A", details: "" },
                    { time: "18:00", type: "food", name: "Kimukatsu 豬排", desc: "四条店", duration: "90分", icon: "utensils", cost: "N/A", hours: "N/A", details: "" }
                ]
            },
            {
                day: 5,
                date: "12.02 (二)",
                location: "京都嵯峨嵐山",
                weather: { temp: "17°~7°", icon: "cloud-sun", desc: "即時預報: 多雲間歇晴朗" },
                activities: [
                    { time: "06:00", type: "transport", name: "出門", desc: "前往四条大宮", duration: "", icon: "person-walking", cost: "N/A", details: "", link: "#map-link-13" },
                    { time: "06:35", type: "transport", name: "嵐山站", desc: "嵐電抵達", duration: "", icon: "train", cost: "N/A", details: "", link: "#map-link-14" },
                    { time: "07:30", type: "spot", name: "天龍寺", desc: "早到先去渡月橋", duration: "50分", icon: "gopuram", cost: "￥500", hours: "08:30~17:00", details: "" },
                    { time: "08:55", type: "spot", name: "寶筐院", desc: "紅葉名所", duration: "35分", icon: "leaf", cost: "￥500", hours: "N/A", details: "" },
                    { time: "09:45", type: "food", name: "嵯峨鳥居本 聖", desc: "抹茶咖啡牛奶", duration: "30分", icon: "mug-hot", cost: "N/A", hours: "N/A", details: "" },
                    { time: "10:50", type: "spot", name: "祇王寺 & 二尊院", desc: "嵐山深處", duration: "60分", icon: "location-dot", cost: "N/A", hours: "N/A", details: "" },
                    { time: "12:10", type: "spot", name: "常寂光寺", desc: "必看楓葉", duration: "30分", icon: "camera", cost: "￥500", hours: "09:00~17:00", details: "" },
                    { time: "13:55", type: "spot", name: "祐齋亭", desc: "★已預約 14:00", duration: "35分", icon: "ticket", cost: "￥3000", hours: "N/A", details: "★已預約" },
                    { time: "15:30", type: "food", name: "八十八良葉舍", desc: "抹茶系列", duration: "20分", icon: "ice-cream", cost: "N/A", hours: "N/A", details: "" },
                    { time: "18:35", type: "spot", name: "鹿王院 (夜楓)", desc: "★已預約 17:00-19:30", duration: "55分", icon: "moon", cost: "￥3500", hours: "17:00-19:30", details: "★已預約" }
                ]
            },
            {
                day: 6,
                date: "12.03 (三)",
                location: "京都東山",
                weather: { temp: "10°~4°", icon: "cloud", desc: "即時預報: 多雲 (Cloudy)" },
                activities: [
                    { time: "05:00", type: "transport", name: "出門", desc: "計程車前往五重塔", duration: "", icon: "taxi", cost: "N/A", details: "06:48日出", link: "#map-link-15" },
                    { time: "06:00", type: "spot", name: "清水寺 仁王門", desc: "仁王門 (06:00開)", duration: "40分", icon: "gopuram", cost: "￥500", hours: "06:00~18:00", details: "京都清水寺1日行程-參觀重點..." },
                    { time: "07:10", type: "spot", name: "八坂神社", desc: "速拍", duration: "20分", icon: "torii-gate", cost: "N/A", hours: "24hr", details: "" },
                    { time: "09:45", type: "spot", name: "南禪寺", desc: "水路閣", duration: "60分", icon: "archway", cost: "￥1600", hours: "08:40~17:00", details: "三門+方丈+南禪院" },
                    { time: "11:05", type: "spot", name: "永觀堂", desc: "楓紅超好拍", duration: "50分", icon: "leaf", cost: "￥1000", hours: "09:00~17:00", details: "" },
                    { time: "13:10", type: "spot", name: "銀閣寺", desc: "哲學之道", duration: "50分", icon: "gopuram", cost: "￥500", hours: "08:30~17:00", details: "" },
                    { time: "14:20", type: "spot", name: "真如堂", desc: "庭院很美", duration: "40分", icon: "tree", cost: "￥1000", hours: "09:00~16:00", details: "" },
                    { time: "15:35", type: "spot", name: "金戒光明寺", desc: "注意時間", duration: "25分", icon: "gopuram", cost: "N/A", hours: "N/A", details: "" },
                    { time: "16:25", type: "spot", name: "先斗町 & 鴨川", desc: "逛街吃飯", duration: "60分", icon: "water", cost: "N/A", hours: "N/A", details: "" }
                ]
            },
            {
                day: 7,
                date: "12.04 (四)",
                location: "京都山科-宇治",
                weather: { temp: "9°~1°", icon: "cloud", desc: "即時預報: 多雲 (Cloudy)" },
                activities: [
                    { time: "06:50", type: "transport", name: "出門", desc: "前往山科", duration: "", icon: "person-walking", cost: "N/A", details: "", link: "#map-link-16" },
                    { time: "08:35", type: "spot", name: "毘沙門堂", desc: "勅使坂紅葉", duration: "45分", icon: "leaf", cost: "￥700", hours: "N/A", details: "" },
                    { time: "10:00", type: "spot", name: "醍醐寺", desc: "世界遺產", duration: "90分", icon: "gopuram", cost: "￥1500", hours: "09:00~17:00", details: "" },
                    { time: "12:30", type: "food", name: "宇治 Food Park", desc: "黑毛和牛", duration: "40分", icon: "utensils", cost: "N/A", hours: "N/A", details: "" },
                    { time: "13:20", type: "spot", name: "平等院鳳凰堂", desc: "10元硬幣圖案", duration: "40分", icon: "coins", cost: "￥500", hours: "08:30~17:30", details: "" },
                    { time: "14:10", type: "food", name: "中村藤吉", desc: "本店吃抹茶", duration: "40分", icon: "mug-hot", cost: "N/A", hours: "10:00~19:00", details: "" },
                    { time: "15:05", type: "spot", name: "宇治上神社", desc: "世界文化遺產", duration: "25分", icon: "torii-gate", cost: "N/A", hours: "N/A", details: "" },
                    { time: "15:40", type: "spot", name: "興聖寺", desc: "琴坂楓葉", duration: "40分", icon: "leaf", cost: "N/A", hours: "N/A", details: "" }
                ]
            },
            {
                day: 8,
                date: "12.05 (五)",
                location: "京都下京-奈良",
                weather: { temp: "12°~2°", icon: "sun", desc: "即時預報: 多數晴朗 (Mostly Sunny)" },
                activities: [
                    { time: "06:30", type: "transport", name: "出門", desc: "前往東福寺", duration: "", icon: "person-walking", cost: "N/A", details: "", link: "#map-link-17" },
                    { time: "08:00", type: "spot", name: "通天橋 & 東福寺", desc: "賞楓第一名", duration: "70分", icon: "leaf", cost: "￥1000", hours: "09:00~16:00", details: "" },
                    { time: "10:10", type: "transport", name: "近鐵奈良站", desc: "抵達奈良", duration: "", icon: "train", cost: "N/A", details: "", link: "#map-link-18" },
                    { time: "11:35", type: "spot", name: "春日大社", desc: "鹿比較溫和", duration: "40分", icon: "torii-gate", cost: "￥700", hours: "09:00~16:00", details: "" },
                    { time: "12:20", type: "food", name: "水谷茶屋", desc: "注意營業時間", duration: "30分", icon: "utensils", cost: "N/A", hours: "N/A", details: "" },
                    { time: "13:35", type: "spot", name: "東大寺", desc: "大佛殿、南大門", duration: "30分", icon: "gopuram", cost: "￥800", hours: "07:30~17:30", details: "" },
                    { time: "16:40", type: "spot", name: "若草山頂", desc: "眺望市區", duration: "40分", icon: "mountain", cost: "N/A", hours: "N/A", details: "" },
                    { time: "19:00", type: "transport", name: "回京都", desc: "近鐵特急", duration: "60分", icon: "train", cost: "N/A", details: "", link: "#map-link-19" }
                ]
            },
            {
                day: 9,
                date: "12.06 (六)",
                location: "京都 洛中 (上京)",
                weather: { temp: "14°~5°", icon: "cloud", desc: "即時預報: 多雲 (Cloudy)" },
                activities: [
                    { time: "07:30", type: "transport", name: "出門", desc: "前往京都御苑", duration: "", icon: "person-walking", cost: "N/A", details: "", link: "#map-link-20" },
                    { time: "08:00", type: "spot", name: "京都御苑", desc: "佔地廣大", duration: "150分", icon: "tree", cost: "N/A", hours: "N/A", details: "" },
                    { time: "11:05", type: "spot", name: "相國寺", desc: "歷史古剎", duration: "25分", icon: "gopuram", cost: "N/A", hours: "N/A", details: "" },
                    { time: "12:10", type: "spot", name: "妙覺寺 & 妙顯寺", desc: "周邊散步", duration: "60分", icon: "location-dot", cost: "N/A", hours: "N/A", details: "" },
                    { time: "13:45", type: "food", name: "SHUHARI KYOTO", desc: "提早排隊", duration: "75分", icon: "utensils", cost: "N/A", hours: "N/A", details: "" },
                    { time: "15:30", type: "spot", name: "晴明神社", desc: "陰陽師迷必去", duration: "20分", icon: "star", cost: "N/A", hours: "09:00~17:00", details: "" },
                    { time: "16:35", type: "spot", name: "白峯神宮", desc: "球類運動守護", duration: "20分", icon: "volleyball", cost: "N/A", hours: "N/A", details: "" },
                    { time: "17:45", type: "food", name: "Mensho Manpuku", desc: "雞白湯拉麵", duration: "40分", icon: "bowl-food", cost: "N/A", hours: "N/A", details: "" }
                ]
            },
            {
                day: 10,
                date: "12.07 (日)",
                location: "京都 -> 台灣",
                weather: { temp: "14°~5°", icon: "sun", desc: "即時預報: 多數晴朗 (Mostly Sunny)" },
                activities: [
                    { time: "08:20", type: "hotel", name: "退房", desc: "行李寄放或帶走", duration: "", icon: "suitcase", cost: "N/A", details: "" },
                    { time: "08:50", type: "transport", name: "長岡天神", desc: "阪急電車", duration: "20分", icon: "train", cost: "N/A", details: "", link: "#map-link-21" },
                    { time: "10:00", type: "spot", name: "光明寺 (預定)", desc: "紅葉迴廊", duration: "60分", icon: "leaf", cost: "N/A", hours: "N/A", details: "車資:￥230" },
                    { time: "12:56", type: "transport", name: "前往機場", desc: "JR 關空快速", duration: "", icon: "train", cost: "N/A", details: "", link: "#map-link-22" },
                    { time: "13:54", type: "arrival", name: "關西機場", desc: "準備登機", duration: "", icon: "plane-departure", cost: "N/A", details: "" },
                    { time: "20:25", type: "arrival", name: "桃園機場", desc: "抵達溫暖的家", duration: "", icon: "house", cost: "N/A", details: "" }
                ]
            }
        ];

        // --- 組件：天氣卡片 (WeatherCard) ---

        const WeatherCard = ({ weather }) => {
            const getIcon = (iconName) => {
                switch(iconName) {
                    case 'sun': return 'fa-sun text-yellow-600'; 
                    case 'cloud': return 'fa-cloud text-gray-500';
                    case 'cloud-sun': return 'fa-cloud-sun text-amber-600';
                    case 'rain': return 'fa-cloud-showers-heavy text-blue-500';
                    case 'snowflake': return 'fa-snowflake text-indigo-200';
                    case 'cloud-rain': return 'fa-cloud-rain text-indigo-400';
                    default: return 'fa-sun';
                }
            };

            return (
                <div className="bg-yellow-50 rounded-lg border border-amber-200 p-4 mb-4 flex items-center justify-between shadow-sm">
                    <div>
                        <div className="text-stone-500 text-xs font-semibold uppercase tracking-wide">
                            {weather.desc.startsWith('即時預報') ? '即時天氣預報 (11/27更新)' : '行程預測天氣 (台灣)'}
                        </div>
                        <div className="text-3xl font-bold text-gray-800 mt-1">{weather.temp}</div>
                        <div className={`text-sm ${weather.desc.startsWith('即時預報') ? 'text-amber-700' : 'text-gray-600'}`}>{weather.desc}</div>
                    </div>
                    <i className={`fas ${getIcon(weather.icon)} text-5xl`}></i>
                </div>
            );
        };

        // --- 組件：活動/交通項目 (ActivityItem) ---

        const ActivityItem = ({ item, isLast }) => {
            
            const isConnector = item.type === 'transport' || item.type === 'arrival';
            const BG_COLOR = '#fcfaf0'; // 全局背景色，用於點的中心

            // 獲取顏色類別
            const getColor = (type) => {
                switch(type) {
                    case 'transport':
                    case 'arrival': return 'bg-gray-100 text-gray-600 border-gray-200'; // 交通：輕盈的灰色
                    case 'spot': return 'bg-amber-100 text-amber-800 border-amber-200'; // 景點：木質/土黃色
                    case 'food': return 'bg-orange-100 text-orange-700 border-orange-200'; // 餐飲：暖色
                    case 'hotel': return 'bg-purple-100 text-purple-700 border-purple-200';
                    case 'shop': return 'bg-yellow-100 text-yellow-700 border-yellow-200';
                    default: return 'bg-gray-100 text-gray-600 border-gray-200';
                }
            };
            
            // 節點邊框顏色：POI/Food 使用楓葉紅，Transport 使用木棕色
            const dotColorClass = (item.type === 'spot' || item.type === 'food' || item.type === 'hotel') ? 'border-red-700' : 'border-amber-700'; 
            
            const containerClasses = `relative pl-16 py-3 pr-4 ${isLast ? 'last-item' : ''}`;
            
            // 使用暖米色作為卡片背景
            let cardClasses = "bg-yellow-50 rounded-lg p-3 border border-amber-200 relative shadow-sm hover:shadow-md transition-shadow";

            // --- 節點渲染邏輯 (極致優化後) ---
            const dotSizeClass = 'w-5 h-5'; // 20px
            // left-[16px] 用來將 20px 的點中心對齊 4px 線條 (left: 24px)
            const dotPositionClass = 'left-[14px] top-[1rem]'; 
            
            const TimelineDot = (
                <div 
                    className={`absolute ${dotPositionClass} ${dotSizeClass} rounded-full z-10 flex items-center justify-center`} 
                    // 為了確保線條和節點完美對齊，使用絕對定位和自定義樣式
                    style={{ 
                        backgroundColor: BG_COLOR, 
                        border: `4px solid ${dotColorClass.replace('border-', 'var(--tw-border-opacity, 1) #')}` 
                    }}
                >
                    {/* 主要停留點 (POI, Food, Hotel) 加上精緻紅點印記 (使用更大的點) */}
                    {(item.type === 'spot' || item.type === 'food' || item.type === 'hotel') && (
                        <i className="fas fa-circle text-red-700 text-xs"></i>
                    )}
                </div>
            );

            // --- 交通連接器 (Transportation Connector) 樣式 ---
            if (isConnector) {
                // 交通連接器：使用更深的米色/淺木紋色
                cardClasses = `bg-yellow-100 rounded-lg p-3 border border-dashed border-amber-300 relative shadow-sm hover:shadow-md transition-shadow`;

                return (
                    <div className={containerClasses}>
                        {/* Timeline Line (竹棕色加粗) */}
                        <div className="timeline-line"></div>
                        
                        {/* Time Bubble (文字超粗體) */}
                        <div className="absolute left-0 top-4 w-12 text-right">
                            <span className="text-sm font-extrabold text-gray-800">{item.time}</span>
                        </div>

                        {/* 節點 */}
                        {TimelineDot}

                        {/* 交通卡片 */}
                        <div className={cardClasses}>
                            <div className="flex justify-between items-center">
                                <div className="flex items-center gap-2">
                                    {/* 交通圖標 (放大且使用主色調) */}
                                    <div className={`w-8 h-8 rounded-full flex items-center justify-center border ${getColor(item.type)}`}>
                                        <i className={`fas fa-${item.icon} text-lg`}></i>
                                    </div>
                                    <div className="flex flex-col">
                                        <h3 className="font-bold text-gray-800 text-base leading-tight">
                                            {item.name}
                                        </h3>
                                        {/* 耗時時間 (突顯) */}
                                        {item.duration && (
                                            <div className="text-sm text-red-700 font-semibold flex items-center gap-1">
                                                <i className="far fa-hourglass-half"></i> {item.duration}
                                            </div>
                                        )}
                                    </div>
                                </div>
                            </div>
                            
                            {/* 交通描述/細節 */}
                            <p className="text-gray-600 text-sm mt-2">{item.desc}</p>
                            
                            {/* 地圖連結 (為交通方案增加路線連結) */}
                            {item.link && (
                                <div className="mt-3 border-t border-amber-300/50 pt-2">
                                    <a href={item.link} target="_blank" className="text-indigo-700 hover:text-indigo-800 text-sm font-medium flex items-center gap-1">
                                        <i className="fas fa-route"></i> 點擊查看路線地圖
                                    </a>
                                </div>
                            )}

                            {/* 詳細備註/資訊欄位 (柔和的楓葉紅) */}
                            {item.details && (
                                <p className="mt-2 text-red-800 bg-red-50 p-1 rounded border border-red-200 text-xs">
                                    <i className="fas fa-exclamation-triangle mr-1"></i> {item.details}
                                </p>
                            )}
                        </div>
                    </div>
                );
            }

            // --- 景點/動作卡片 (POI/Action) 樣式 ---
            return (
                <div className={containerClasses}>
                    {/* Timeline Line (竹棕色加粗) */}
                    <div className="timeline-line"></div>
                    
                    {/* Time Bubble (文字超粗體) */}
                    <div className="absolute left-0 top-4 w-12 text-right">
                        <span className="text-sm font-extrabold text-gray-800">{item.time}</span>
                    </div>

                    {/* 節點 */}
                    {TimelineDot}

                    {/* 景點/動作卡片 */}
                    <div className={cardClasses}>
                        <div className="flex justify-between items-start">
                            <div className="flex items-center gap-2 mb-1">
                                {/* 圓形 Icon (柔和配色) */}
                                <div className={`w-8 h-8 rounded-full flex items-center justify-center border ${getColor(item.type)}`}>
                                    <i className={`fas fa-${item.icon} text-xs`}></i>
                                </div>
                                <h3 className="font-bold text-gray-800 text-lg leading-tight">{item.name}</h3>
                            </div>
                        </div>
                        
                        {/* 簡短描述 */}
                        <p className="text-gray-600 text-sm mt-1 pl-10">{item.desc}</p>

                        {/* 詳細資訊區塊 */}
                        <div className="mt-3 border-t border-amber-100 pt-2 pl-10">
                            <div className="flex justify-between items-start text-xs text-gray-500">
                                {/* 費用與開放時間 */}
                                <div className="flex flex-col gap-1">
                                    <div className="flex items-center gap-1">
                                        <i className="fas fa-wallet w-3 text-center"></i>
                                        <span className="font-medium text-gray-700">{item.cost || 'N/A'}</span>
                                    </div>
                                    {item.hours && item.hours !== 'N/A' && (
                                        <div className="flex items-center gap-1">
                                            <i className="far fa-clock w-3 text-center"></i>
                                            <span>{item.hours}</span>
                                        </div>
                                    )}
                                </div>
                                
                                {/* 停留時間與地圖連結 (景點地圖連結) */}
                                <div className="flex flex-col gap-1 items-end">
                                    {item.duration && (
                                        <div className="text-xs text-gray-400 flex items-center gap-1">
                                            <i className="far fa-hourglass-half"></i> 停留 {item.duration}
                                        </div>
                                    )}
                                    {/* 修正地圖連結，使用 item.link */}
                                    {item.link && (
                                        <a href={item.link} target="_blank" className="text-indigo-600 text-xs hover:underline flex items-center gap-1">
                                            <i className="fas fa-map-marker-alt"></i> 查看地圖
                                        </a>
                                    )}
                                </div>
                            </div>

                            {/* 詳細備註/資訊欄位 (使用柔和的楓葉紅) */}
                            {item.details && (
                                <p className="mt-2 text-red-800 bg-red-50 p-1 rounded border border-red-200 text-xs">
                                    <i className="fas fa-exclamation-triangle mr-1"></i> {item.details}
                                </p>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        // --- 組件：應用程式主體 (App) ---
        
        const App = () => {
            const [selectedDayIndex, setSelectedDayIndex] = useState(1); 
            const currentTrip = tripData[selectedDayIndex];
            const totalDays = tripData.length; // 總天數

            // 導航邏輯：上一天
            const goToPrevDay = () => {
                setSelectedDayIndex(prevIndex => Math.max(0, prevIndex - 1));
            };

            // 導航邏輯：下一天
            const goToNextDay = () => {
                setSelectedDayIndex(prevIndex => Math.min(totalDays - 1, prevIndex + 1));
            };

            useEffect(() => {
                window.scrollTo(0, 0);
            }, [selectedDayIndex]);

            return (
                <div className="max-w-md mx-auto min-h-screen pb-20 bg-[#fcfaf0]"> 
                    {/* Header (使用深沉的楓葉紅色/木質色) */}
                    <header className="bg-red-800 text-white p-6 rounded-b-xl kyoto-header sticky top-0 z-50">
                        
                        {/* 標題與左右導航按鈕 */}
                        <div className="flex justify-between items-center mb-4">
                            
                            {/* 左側: 標題資訊 */}
                            <div>
                                <h1 className="text-2xl font-bold">京都秋楓之旅</h1>
                                <p className="text-red-200 text-sm opacity-90">2025.11.28 - 12.07</p>
                            </div>
                            
                            {/* 右側: 日期切換按鈕與 Day Counter (新增左右按鈕) */}
                            <div className="flex items-center gap-2">
                                {/* 向左按鈕 */}
                                <button 
                                    onClick={goToPrevDay} 
                                    disabled={selectedDayIndex === 0}
                                    className={`bg-white/10 w-8 h-8 rounded-full flex items-center justify-center transition-colors ${selectedDayIndex === 0 ? 'opacity-30 cursor-not-allowed' : 'hover:bg-white/20'}`}
                                >
                                    <i className="fas fa-chevron-left text-sm"></i>
                                </button>

                                {/* Day Counter */}
                                <div className="bg-white/10 backdrop-blur-sm border-2 border-yellow-300 p-2 rounded-lg text-center min-w-[60px]">
                                    <div className="text-xs text-red-200">Day</div>
                                    <div className="text-xl font-bold text-yellow-300">{currentTrip.day}</div>
                                </div>

                                {/* 向右按鈕 */}
                                <button 
                                    onClick={goToNextDay} 
                                    disabled={selectedDayIndex === totalDays - 1}
                                    className={`bg-white/10 w-8 h-8 rounded-full flex items-center justify-center transition-colors ${selectedDayIndex === totalDays - 1 ? 'opacity-30 cursor-not-allowed' : 'hover:bg-white/20'}`}
                                >
                                    <i className="fas fa-chevron-right text-sm"></i>
                                </button>
                            </div>
                        </div>

                        {/* Day Scroller (保留，作為快速跳轉的選項) */}
                        <div className="flex gap-3 overflow-x-auto hide-scrollbar pb-2">
                            {tripData.map((d, idx) => (
                                <button
                                    key={idx}
                                    onClick={() => setSelectedDayIndex(idx)}
                                    className={`flex-shrink-0 px-4 py-2 rounded-full text-sm font-medium transition-all ${
                                        selectedDayIndex === idx 
                                        ? 'bg-yellow-100 text-red-800 shadow-lg transform scale-105' /* 選中：暖米色底楓葉紅字 */
                                        : 'bg-red-900/50 text-red-100 hover:bg-red-900' /* 未選：深紅底白字 */
                                    }`}
                                >
                                    Day {d.day}
                                </button>
                            ))}
                        </div>
                    </header>

                    {/* Main Content */}
                    <main className="p-4">
                        <div className="mb-4">
                            <h2 className="text-xl font-bold text-gray-800 flex items-center gap-2">
                                <i className="fas fa-map-pin text-red-700"></i> 
                                {currentTrip.date}
                            </h2>
                            <p className="text-gray-500 text-sm ml-7">{currentTrip.location}</p>
                        </div>

                        {/* Weather Widget */}
                        <WeatherCard weather={currentTrip.weather} />

                        {/* Timeline */}
                        <div className="mt-6">
                            {currentTrip.activities.map((item, idx) => (
                                <ActivityItem 
                                    key={idx} 
                                    item={item} 
                                    isLast={idx === currentTrip.activities.length - 1} 
                                />
                            ))}
                        </div>
                    </main>
                    
                    {/* Floating Map Button (主地圖連結 - 使用安全佔位符) */}
                    <div className="fixed bottom-6 right-6">
                        <a href="#main-map" target="_blank" className="bg-indigo-700 hover:bg-indigo-800 text-white w-14 h-14 rounded-full shadow-xl flex items-center justify-center transition-transform hover:scale-110">
                            <i className="fas fa-map text-xl"></i>
                        </a>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
